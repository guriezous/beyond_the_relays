############################
##### MIGRANT FLEET #####
############################

##### VALHALLAN THRESHOLD #####

sys_sandbox_raheelleyya_init = {
    name = "Raheel-Leyya"
    class = "sc_binary_b_b"
	flags = { terminus_system valhallan_threshold_system raheelleyya_system btr_system sandbox_map  custom_system empire_home_system }

	init_effect = { 
		random_country = { 
			limit = { has_country_flag = migrant_fleet } 
			save_global_event_target_as = migrant_fleet
		}	
	generate_home_system_resources = yes
	}

	usage = custom_empire
	max_instances = 1

    asteroid_belt = {
        type = rocky_asteroid_belt
        radius = 130
    }

    planet = {
		name = "Raheel-Leyya_A"
        class = "pc_b_super_star"
        size = 15
        orbit_distance = 30
        orbit_angle = { min = 90 max = 270 }
    }

    planet = {
        class = "pc_b_super_star"
        name = "Raheel-Leyya_B"
        size = 25 
        orbit_distance = 0
        orbit_angle = 180
	}
			
	planet ={ 
		name = "Susskind Station"
		class = "pc_habitat"
		orbit_angle = { min =90 max = 270}
		orbit_distance = 30
		size = 8
		starting_planet = yes
		deposit_blockers = none 
		modifiers = none
		flags = { rayya_fleet pd_ignore }
		init_effect = {
			prevent_anomaly = yes
			set_global_flag = quarian_fleet_spawned
			if = {
				limit = { NOT = { any_country = { has_country_flag = migrant_fleet } } }
				create_species = { 
					name = "Quarian"
					class = QUA
					portrait = quarian
					#homeworld = THIS 
					traits = { 
				  trait="btr_quarian_weak_immune_system"
				  trait="btr_quarian_adept_engineers"
				  trait="trait_rapid_breeders"
				  trait="trait_weak"
					  # ideal_planet_class = "pc_dextro_savannah"
					}
				  }
				  last_created_species = { save_global_event_target_as = quarianSpecies }
				create_country = {
					name = "The Migrant Fleet"
					ship_prefix = ""
					type = default
					origin = "origin_migrant_fleet"
					ignore_initial_colony_error = yes
					civics = { civic = "civic_btr_quarian_last_of_the_quarians" civic = "civic_btr_quarian_the_conclave" }
					authority = auth_democratic
					name_list = "btr_quarian"
					ethos = { ethic = "ethic_egalitarian" ethic = "ethic_fanatic_materialist" }
					species = event_target:quarianSpecies
					flag = {
						icon={
							category="masseffect"
							file="Migrant Fleet.dds"
						}
						background={
							category="backgrounds"
							file="00_solid.dds"
						}
						colors={
							"dark_purple"
							"black"
							"null"
							"null"
						}
					}
					effect = {
						set_graphical_culture = quar_01
						set_country_flag = migrant_fleet
						set_country_flag = init_spawned
						set_country_flag = custom_start_screen
						set_country_flag = sandbox_map
						save_global_event_target_as = migrant_fleet
					}
				}
			}	
			set_capital = yes
			random_country = {
				limit = { has_country_flag = migrant_fleet }
				save_global_event_target_as = migrant_fleet
				species = { save_global_event_target_as = quarianSpecies }
			}
			set_owner = event_target:migrant_fleet
			generate_btr_start_deposits_and_blockers = yes
			generate_btr_major_empire_start_buildings = yes
			generate_rayya_pops = yes
			set_name = "Rayya"
		}
	}
	
	# init_effect = {
	# 	save_global_event_target_as = migrant_fleet_home_system
	# 	create_species = {
	# 		name = "Quarian"
	# 		plural = "Quarians"
	# 		adjective = "Quarian"
	# 		class = "QUA"
	# 		portrait = quarian
	# 		name_list = btr_quarian
	# 		traits = {
	# 			trait="trait_natural_engineers"
	# 	        trait="trait_nonadaptive"
	# 	        trait="trait_communal"
	# 	        trait="trait_traditional"
	# 	        trait="trait_quick_learners"
	# 			ideal_planet_class = "pc_savannah" 
	# 		}
	# 	}
	# 	create_country = {
	# 		name_list = btr_quarian
	# 		species = last_created
	# 		type = migrant_fleet
	# 		authority = auth_oligarchic
	# 		civics = {
	# 			civic = civic_caravaneer_fleet1
	# 		}
	# 		flag = {
	# 			icon={
	# 				category="masseffect"
	# 				file="Migrant Fleet.dds"
	# 			}
	# 			background={
	# 				category="backgrounds"
	# 				file="00_solid.dds"
	# 			}
	# 			colors={
	# 				"dark_purple"
	# 				"black"
	# 				"null"
	# 				"null"
	# 			}
	# 		}
	# 		ethos = {
	# 			ethic = ethic_egalitarian
	#             ethic = ethic_materialist
	# 		}
	# 		ignore_initial_colony_error = yes
	# 		effect = {
	# 			set_country_flag = migrant_fleet
	# 			set_graphical_culture = caravaneer_01
	# 			save_global_event_target_as = migrant_fleet
	# 			create_leader = {
	# 				class = admiral
	# 				species = event_target:quarianSpecies
	# 				name = "Zaal'Koris vas Qwib-Qwib"
	# 				gender = male
	# 				skill = 5
	# 				immortal = yes
	# 			}
	# 			create_fleet = {
	# 				name = "Migrant Fleet"
	# 				settings = { spawn_debris = no }
	# 				effect = {
	# 					set_fleet_stance = passive
	# 					set_formation_scale = 2.5
	# 					set_owner = prev
	# 					create_ship = {
	# 						name = "Chayym"
	# 						design = migrant_fleet_liveship
	# 						effect = {
	# 							set_ship_flag = migrant_fleet_liveship_chayym
	# 							save_global_event_target_as = migrant_fleet_liveship_chayym
	# 						}
	# 					}
	# 					create_ship = {
	# 						name = "Rayya"
	# 						design = migrant_fleet_liveship
	# 						effect = {
	# 							set_ship_flag = migrant_fleet_liveship_rayya
	# 							save_global_event_target_as = migrant_fleet_liveship_rayya
	# 						}
	# 					}
	# 					create_ship = {
	# 						name = "Shellen"
	# 						design = migrant_fleet_liveship
	# 						effect = {
	# 							set_ship_flag = migrant_fleet_liveship_shellen
	# 							save_global_event_target_as = migrant_fleet_liveship_shellen
	# 						}
	# 					}
	# 					while = {
	# 						count = 30
	# 						create_ship = {
	# 							name = random
	# 							design = migrant_fleet_frigate
	# 						}
	# 					}
	# 					while = {
	# 						count = 14
	# 						create_ship = {
	# 							name = random
	# 							design = migrant_fleet_cruiser
	# 						}
	# 					}
	# 					set_location = {
	# 						target = event_target:migrant_fleet_home_star
	# 						angle = 90
	# 						distance = 40
	# 					}
	# 					set_fleet_flag = migrant_fleet_1
	# 					save_global_event_target_as = migrant_fleet1_fleet
	# 					prev = {
	# 						set_custom_capital_location = event_target:migrant_fleet1_fleet
	# 					}
	# 					assign_leader = last_created_leader
	# 				}
	# 			}
	# 			create_leader = {
	# 				class = ruler
	# 				species = event_target:quarianSpecies
	# 				name = "Admiral Shala'Raan vas Tonbay"
	# 				skill = 5
	# 				immortal = yes
	# 			}
	# 			set_leader = last_created_leader
	# 		}
	# 	}
	# 	last_created_country = {
	# 		set_name = "Migrant Fleet"
	# 	}

    init_effect = { 
		spawn_megastructure = { 
			type = "theshrikeabyssal_valhallanthreshold_massrelay" 
			name = "Valhallan 4 Relay"
			orbit_angle = 73 
			orbit_distance = 200
			
		} 
	}

}